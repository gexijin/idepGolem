<h3>
    Overview
</h3>
<p>
    The Pre-Process tab prepares expression data for downstream analysis. The
    workflow (1) filters genes with negligible expression, (2) converts uploaded
    identifiers to Ensembl or STRING IDs, and (3) applies appropriate
    transformations so comparisons across samples are meaningful. Each option in
    the sidebar updates the preview plots and summaries in real time.
</p>
<h3>
    Data Preparation Steps
</h3>
<ul>
    <li>
        <strong>Upload &amp; inspect:</strong> view table previews and basic
        statistics for the uploaded matrix before any filtering.
    </li>
    <li>
        <strong>Filter low expression:</strong> remove genes that fail CPM/FPKM
        thresholds so that noise does not dominate clustering or differential
        expression analysis.
    </li>
    <li>
        <strong>Transform counts:</strong> choose among VST, rlog, or log2 with a
        pseudo-count to stabilize variance across samples.
    </li>
    <li>
        <strong>Confirm quality:</strong> boxplots, density plots, and interactive
        tables help validate that processing choices produce sensible
        distributions.
    </li>
</ul>
<h3>
    Filtering Counts Data
</h3>
<p>
    RNA-seq counts are normalized to counts per million (CPM) using
    <em>edgeR</em>. By default a gene must exceed 0.5 CPM in at least one sample
    (adjustable via <strong>minCPM</strong> and <strong>n libraries</strong>). Genes
    failing this requirement are discarded, which commonly removes 30–50% of the
    genome where expression is undetectable in the chosen tissue.
</p>
<p>
    Increase the CPM threshold when sequencing depth is high to keep only robust
    signals, or loosen it (e.g., 0.2 CPM for 50M-read libraries) to save low but
    potentially important transcripts. The settings also determine whether iDEP
    issues warnings about a very small number of retained genes (< 1,000 by
    default) because that affects enrichment background calculations.
</p>
<h3>
    Transformations for Counts Data
</h3>
<p>
    After filtering, select the transformation that best matches the study
    design. The transformed matrix powers clustering, PCA, t-SNE, and optional
    limma-trend analysis.
</p>
<ul>
    <li>
        <strong>Variance Stabilizing Transform (VST):</strong> moderates the
        variance of highly expressed genes according to Anders &amp; Huber (2010).
        Good default for moderate sample sizes.
    </li>
    <li>
        <strong>rlog:</strong> regularized log transform from DESeq2. Produces
        balanced distributions but is slower for &gt;10 samples.
    </li>
    <li>
        <strong>Log2(x + c):</strong> adds a pseudo-count <em>c</em> (default 4) to
        stabilize low counts. This is equivalent to logCPM if libraries were
        scaled to 1M reads; iDEP instead uses DESeq2’s size factors before
        applying the log.
    </li>
</ul>
<p>
    Inspect the transformation effects using the technical replicate plots and
    density views. Aggressive transformations can shrink biological differences,
    whereas minimal transformation leaves heteroscedastic noise in place.
</p>
<p>
    <img src="https://idepsite.files.wordpress.com/2017/03/transform3.png" alt="Comparison of transformations" style="max-width: 100%; height: auto;">
</p>
<p>
    The figure above compares technical replicates before and after applying VST,
    rlog, or a simple log transform. Notice how VST compresses the range most
    aggressively, while rlog and log2(x + c) retain slightly more spread. Use it
    as a guide: if your replicates look similar to the middle panel you are
    removing unwanted noise without flattening real biology.
</p>
<h3>
    Normalized Expression (FPKM, TPM, Microarray)
</h3>
<p>
    For already normalized matrices, filtering relies on absolute expression
    thresholds rather than CPM. The default keeps genes expressed at level &ge; 1
    in at least one sample; adjust the value to reflect the measurement scale.
    For microarray log-ratio data, set the cutoff to a large negative number to
    disable filtering entirely.
</p>
<p>
    iDEP automatically evaluates kurtosis across samples and recommends log2
    transformation when extremely skewed values are detected. This safeguard
    reduces the impact of single outlier arrays or normalization artifacts.
</p>
<p>
    <img src="https://idepsite.files.wordpress.com/2018/03/download-e1521424299439.png?w=768&h=503" alt="Library depth comparison" style="max-width: 100%; height: auto;">
</p>
<p>
    This bar chart highlights an experiment where certain groups received far
    fewer reads. When the tallest bar is more than three times the height of the
    shortest one, downstream methods like limma-trend can become unreliable. In
    those cases consider alternative differential expression workflows or
    revisit library preparation and sequencing balance.
</p>
<h3>
    Gene ID Conversion
</h3>
<p>
    Once filtering and transformation options are set, iDEP maps uploaded gene
    identifiers to Ensembl or STRING IDs using the selected species database. A
    summary of matched and unmatched IDs appears in the data preview so you can
    confirm coverage before moving on to downstream tabs.
</p>
<h3>
    Quality Diagnostics
</h3>
<ul>
    <li>
        <strong>Boxplot:</strong> compares sample distributions before and after
        transformation. Large shifts may indicate the need for alternative
        pseudo-counts or normalization choices.
    </li>
    <li>
        <strong>Density plot:</strong> visualizes overall expression patterns and
        highlights whether technical replicates overlap. The figure width adapts
        to the browser window.
    </li>
    <li>
        <strong>Data table:</strong> toggles between transformed and raw counts
        for spot-checking individual genes.
    </li>
</ul>
<h3>
    Quick Tips
</h3>
<ul>
    <li>
        Start with default filters, then relax thresholds gradually if too few
        genes pass.
    </li>
    <li>
        Use the Tukey HSD option on boxplots to flag sample groups with
        significant mean differences before committing to downstream analyses.
    </li>
    <li>
        Keep an eye on library-size plots; if one group has &gt;3× fewer reads,
        avoid limma-trend for differential expression.
    </li>
    <li>
        After major adjustments, regenerate the report from the sidebar to
        capture chosen parameters.
    </li>
</ul>
<h3>
    References
</h3>
<ul>
    <li>
        Anders, S. &amp; Huber, W. (2010). Differential expression analysis for
        sequence count data. <em>Genome Biology</em> 11(10):R106.
    </li>
    <li>
        Love, M. I., Huber, W. &amp; Anders, S. (2014). Moderated estimation of fold
        change and dispersion for RNA-seq data with DESeq2. <em>Genome Biology</em>
        15(12):550.
    </li>
    <li>
        edgeR User Guide: <a href="https://bioconductor.org/packages/edgeR" target="_blank">https://bioconductor.org/packages/edgeR</a>
    </li>
</ul>
