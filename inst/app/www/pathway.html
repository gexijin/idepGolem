<h3>
    Overview
</h3>
<p>
    The Pathway tab reuses the fold-change values generated in DEG1 to score every
    pathway or gene set in the selected database. Because it analyses the full set of
    genes (not just the significant list), it can reveal coordinated but modest
    expression shifts that DEG2 enrichment might miss.
</p>
<p>
    This approach differs from the enrichment tools under DEG2, which only examine
    genes classified as up- or down-regulated. Pathway analysis here considers the
    entire ranked list of genes, so pathways may surface even when individual genes do
    not pass DEG thresholds.
</p>
<h3>
    Getting Started
</h3>
<ul>
    <li>
        Click <strong>Submit</strong> after choosing a contrast and method; results
        update only when the button is pressed.
    </li>
    <li>
        Use the <strong>Comparison</strong> selector to pick a DEG1 contrast (“B-A”
        indicates fold change relative to A) or choose “All samples” for PGSEA with all
        groups.
    </li>
    <li>
        Select a <strong>Pathway analysis method</strong> and, if prompted, its specific
        options (for example, the GAGE metric).
    </li>
    <li>
        Choose the <strong>Gene-set database</strong> (GO, KEGG, Reactome, TF/miRNA
        targets, etc.) from the dropdown rendered beneath the method selector.
    </li>
</ul>
<h3>
    Sidebar Controls
</h3>
<ul>
    <li>
        <strong>Pathway significance cutoff (FDR):</strong> filters results to pathways
        with adjusted p-values at or below the chosen threshold.
    </li>
    <li>
        <strong>More options:</strong> reveals extra sliders/toggles such as gene-set size
        limits, number of top pathways to show, and the gene-level FDR filter applied
        before analysis.
    </li>
    <li>
        <strong>Gene-set size (Min/Max):</strong> exclude sets that are too small (often
        noisy) or too large (overly generic).
    </li>
    <li>
        <strong>Number of top pathways:</strong> controls how many entries appear in the
        summary tables and plots.
    </li>
    <li>
        <strong>Remove genes with big FDR:</strong> discards genes whose DEG1 adjusted
        p-values exceed the specified threshold before pathway scoring.
    </li>
    <li>
        <strong>Use absolute values of fold changes:</strong> treats up- and
        down-regulation equally (useful for pathways where mixed regulation indicates
        activation, such as signalling cascades).
    </li>
    <li>
        <strong>Show pathway IDs:</strong> appends identifiers (for example, GO terms or
        KEGG IDs) to pathway names in the output.
    </li>
    <li>
        <strong>Report / Heatmap data:</strong> download an HTML report of all results or
        the expression matrix used in the pathway heatmap.
    </li>
    <li>
        <strong>PGSEA colour palette:</strong> when using PGSEA, choose the colour scheme
        applied to the sample-by-pathway heatmap.
    </li>
</ul>
<h3>
    Method Details
</h3>
<ul>
    <li>
        <strong>GAGE:</strong> evaluates pathway-level fold changes using either DEG1 fold
        changes or expression values. It can contrast up- and down-regulated pathways
        separately via the Network tab filters.
    </li>
    <li>
        <strong>GSEA (fgsea):</strong> runs fast preranked enrichment by ordering genes on
        fold change. Scores reflect whether pathway members accumulate toward the top or
        bottom of the ranked list.
    </li>
    <li>
        <strong>PGSEA:</strong> computes average expression shifts for pathways on a
        per-comparison basis. “PGSEA w/ all samples” generates a sample × pathway matrix
        for exploratory clustering.
    </li>
    <li>
        <strong>ReactomePA:</strong> performs Reactome-focused enrichment and provides
        pathway relationship plots via the Enrichment tab.
    </li>
    <li>
        <strong>GSVA/ssGSEA/PLAGE:</strong> single-sample scoring methods that transform
        the expression matrix into per-sample pathway scores, ideal for comparisons across
        multiple groups or time points.
    </li>
    <li>
        <strong>Pathview:</strong> when KEGG is selected, overlays fold changes onto KEGG
        diagrams for the chosen pathway.
    </li>
</ul>
<h3>
    Output Tabs
</h3>
<ul>
    <li>
        <strong>Significant pathways:</strong> table of enriched pathways with download
        links for the CSV summary and leading-edge gene lists.
    </li>
    <li>
        <strong>Tree:</strong> hierarchical clustering of pathways based on shared genes.
        Use browser width to tame size warnings and download a static figure.
    </li>
    <li>
        <strong>Network:</strong> interactive graph where nodes are pathways. Adjust the
        edge cutoff (shared gene fraction), toggle text wrapping, switch layouts, and—for
        GAGE/GSEA—filter to up- or down-regulated pathways.
    </li>
    <li>
        <strong>Heatmap:</strong> visualises the expression of genes driving each pathway.
        The “Heatmap Data” download contains the matrix used for plotting.
    </li>
    <li>
        <strong>KEGG:</strong> once KEGG is selected as the database and the analysis has
        run, pick an enriched pathway to render a coloured KEGG diagram. Options let you
        include all KEGG pathways, adjust colours, and download the image.
    </li>
    <li>
        <strong>Info:</strong> opens this documentation within the app.
    </li>
</ul>
<h3>
    Interpretation Tips
</h3>
<ul>
    <li>
        Compare outputs from multiple methods to confirm robust signals—no single method
        is best for every dataset.
    </li>
    <li>
        Remember that enrichment suggests association, not necessarily direct pathway
        activation; cross-check with biological context or external databases.
    </li>
    <li>
        Use the Network and Tree tabs to spot clusters of related pathways that may point
        to overarching processes (for example, immune activation or metabolism).
    </li>
    <li>
        When Pathview is slow, queue it after other analyses or limit the number of
        pathways requested.
    </li>
    <li>
        Guard against “P-hacking”: repeatedly tweaking databases, filters, and methods can
        produce pathways that appear significant by chance. Treat marginal p-values with
        caution and focus on patterns that replicate across contrasts or datasets.
    </li>
</ul>
<h3>
    References
</h3>
<p>
    Fabregat, A., Sidiropoulos, K., Garapati, P., Gillespie, M., Hausmann, K., Haw, R.,
    Jassal, B., Jupe, S., Korninger, F., McKay, S., et al. (2016). The Reactome pathway
    Knowledgebase. Nucleic Acids Res 44, D481-487.
</p>
<p>
    Furge, K., and Dykema, K. (2012). PGSEA: Parametric Gene Set Enrichment Analysis. R
    package version 1480.
</p>
<p>
    Kanehisa, M., Furumichi, M., Tanabe, M., Sato, Y., and Morishima, K. (2017). KEGG:
    new perspectives on genomes, pathways, diseases and drugs. Nucleic Acids Res 45,
    D353-D361.
</p>
<p>
    Kim, S.Y., and Volsky, D.J. (2005). PAGE: parametric analysis of gene set
    enrichment. BMC Bioinformatics 6, 144.
</p>
<p>
    Luo, W., and Brouwer, C. (2013). Pathview: an R/Bioconductor package for
    pathway-based data integration and visualization. Bioinformatics 29, 1830-1831.
</p>
<p>
    Sergushichev, A. (2016). An algorithm for fast preranked gene set enrichment
    analysis using cumulative statistic calculation. bioRxiv
    http://biorxiv.org/content/early/2016/06/20/060012.
</p>
<p>
    Subramanian, A., Tamayo, P., Mootha, V.K., Mukherjee, S., Ebert, B.L., Gillette,
    M.A., Paulovich, A., Pomeroy, S.L., Golub, T.R., Lander, E.S., et al. (2005). Gene
    set enrichment analysis: a knowledge-based approach for interpreting genome-wide
    expression profiles. Proc Natl Acad Sci U S A 102, 15545-15550.
</p>
<p>
    Yu, G., and He, Q.Y. (2016). ReactomePA: an R/Bioconductor package for Reactome
    pathway analysis and visualization. Mol Biosyst 12, 477-479.
</p>
